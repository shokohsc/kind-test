---
apiVersion: v1
kind: ConfigMap
metadata:
  name: sidekick-script
data:
  openvpn.sh: |
    #!/usr/bin/env bash
    if [[ -f /vpn/vpn_conf.ovpn ]]; then
        rm /vpn/vpn_conf.ovpn
    fi
    touch /vpn/vpn_conf.ovpn
    curl -Lkso /vpn/vpn_conf.ovpn $SIDEKICK_URL || (echo 'Cannot curl ovpn profile' && exit 1);
    /sbin/tini -s -- /usr/bin/openvpn.sh $@
