---
extraPorts:
  - name: peerflix
    containerPort: 9000
    protocol: TCP

extraVolumes:
  volumes:
    - name: data
      emptyDir: {}

sidecars:
  - name: peerflix
    image:
      repository: shokohsc/peerflix-server
      tag: latest
      pullPolicy: IfNotPresent
    volumeMounts:
      - name: data
        mountPath: /tmp/torrent-stream
    livenessProbe:
      exec:
        command:
          - curl
          - -lksX
          - GET
          - "http://localhost:9000"
    startupProbe:
      exec:
        command:
          - sh
          - -c
          - "ps -fe | grep 'no[d]e ./server/bin.js'"
